## 问题定位
- 解析器仅匹配英文标题格式 `Scene <数字>:`，若模型输出为其他语言（如“场景 1：”）或未严格遵循模板，解析会失败。
- 现有解析函数 `utils/parser.ts:9-69` 使用正则 `/Scene\s*\d+:([\s\S]*?)(?=Scene\s*\d+:|$)/g`，对中文或变体不兼容。
- Ark 分镜生成后在 `services/providers/arkProvider.ts:104-107` 解析文本；当解析失败时描述可能退化为“Could not parse scenes”，导致后续生图阶段也失败。

## 改进方案
1. 解析器增强（兼容中英文与变体）
- 修改场景块匹配为：`/(?:Scene|场景)\s*\d+[:：]([\s\S]*?)(?=(?:Scene|场景)\s*\d+[:：]|$)/g`
- 关键字段提取支持中英文键名：
  - `Subject|主体`、`Environment|环境`、`Lighting|光照|灯光`、`Grade|色彩|风格`、`Action Cues|动作提示`
- 若关键字段缺失，使用首行标题作为描述，不再返回“Could not parse scenes”，而是降级生成。

2. 分镜生成提示词收敛（Ark/Gemini）
- 在系统提示中明确要求：
  - 标题必须使用英文 `Scene 1:`、`Scene 2:` ...
  - 全文只输出结构化脚本，不输出其他说明
  - 关键字段必须使用英文键名（与解析器对齐）
- 调整生成参数：`temperature=0`、`max_tokens` 充足（已在 Settings 可配）。

3. 容错与日志
- Ark Provider 在解析失败时不抛错，改为采用解析器的降级结果（首行标题）继续生成图像。
- 当发生降级解析，UI 提示“已自动调整格式以继续生成”，并在控制台打印原始文本以便调试。

4. 验证
- 用中文/英文提示生成分镜，均能解析出至少 1 个场景，并顺利进行生图。
- 多场景输出严格包含 `Scene n:` 标题；解析正确提取关键信息生成图。

## 涉及修改
- `utils/parser.ts`：正则与键名匹配增强、降级策略优化。
- `services/providers/arkProvider.ts`：失败不抛错，继续生成并提示。
- 分镜系统提示：加强格式约束（Ark 与 Gemini 共用）。

## 风险
- 更宽松的解析可能会误抓段落；通过关键字段加权与首行标题作为降级策略降低风险。